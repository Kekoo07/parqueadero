<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parqueadero de Motos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
    <div id="app" class="max-w-6xl mx-auto"></div>

    <script>
        // Estado de la aplicaci√≥n
        let state = {
            vehicles: JSON.parse(localStorage.getItem('vehicles') || '[]'),
            monthlyPasses: JSON.parse(localStorage.getItem('monthlyPasses') || '[]'),
            extrasIncome: JSON.parse(localStorage.getItem('extrasIncome') || '[]'),
            activeTab: 'entrada',
            placa: '',
            tarifaPorMinuto: 100,
            valorPlena: 15000,
            extraConcepto: '',
            extraMonto: ''
        };

        // Guardar en localStorage
        function saveData() {
            localStorage.setItem('vehicles', JSON.stringify(state.vehicles));
            localStorage.setItem('monthlyPasses', JSON.stringify(state.monthlyPasses));
            localStorage.setItem('extrasIncome', JSON.stringify(state.extrasIncome));
        }

        // Registrar entrada
        function registrarEntrada() {
            if (!state.placa.trim()) {
                alert('Por favor ingrese una placa');
                return;
            }

            const placaUpper = state.placa.toUpperCase();
            const existeActivo = state.vehicles.find(v => v.placa === placaUpper && !v.horaSalida);
            
            if (existeActivo) {
                alert('Esta moto ya est√° registrada en el parqueadero');
                return;
            }

            const nuevoVehiculo = {
                id: Date.now(),
                placa: placaUpper,
                horaEntrada: new Date().toISOString(),
                horaSalida: null,
                totalPagar: 0,
                pagado: false,
                conPlena: false
            };

            state.vehicles.unshift(nuevoVehiculo);
            state.placa = '';
            saveData();
            alert(`Moto ${placaUpper} registrada.`);
            render();
        }

        // Calcular total
        function calcularTotal(horaEntrada) {
            const entrada = new Date(horaEntrada);
            const salida = new Date();
            const minutos = Math.ceil((salida - entrada) / (1000 * 60));
            return minutos * state.tarifaPorMinuto;
        }

        // Registrar salida
        function registrarSalida(id, usarPlena = false) {
            const vehiculo = state.vehicles.find(v => v.id === id);
            if (!vehiculo) return;

            let total;
            let mensaje;

            if (usarPlena) {
                total = state.valorPlena;
                mensaje = `Salida registrada para ${vehiculo.placa}\n\n‚úÖ PLENA\nTotal a pagar: ${formatearMoneda(total)}`;
            } else {
                total = calcularTotal(vehiculo.horaEntrada);
                const entrada = new Date(vehiculo.horaEntrada);
                const salida = new Date();
                const minutos = Math.ceil((salida - entrada) / (1000 * 60));
                mensaje = `Salida registrada para ${vehiculo.placa}\n\nTiempo: ${minutos} minuto(s)\nTotal a pagar: ${formatearMoneda(total)}`;
            }
            
            state.vehicles = state.vehicles.map(v => 
                v.id === id 
                    ? { ...v, horaSalida: new Date().toISOString(), totalPagar: total, pagado: true, conPlena: usarPlena }
                    : v
            );
            saveData();
            alert(mensaje);
            render();
        }

        // Eliminar registro del historial
        function eliminarRegistro(id) {
            if (confirm('¬øEst√° seguro de eliminar este registro?')) {
                state.vehicles = state.vehicles.filter(v => v.id !== id);
                saveData();
                render();
            }
        }

        // Limpiar todo el historial
        function limpiarHistorial() {
            const historial = state.vehicles.filter(v => v.horaSalida);
            if (historial.length === 0) {
                alert('No hay registros en el historial para eliminar');
                return;
            }
            
            if (confirm(`¬øEst√° seguro de eliminar TODOS los registros del historial? (${historial.length} registros)`)) {
                state.vehicles = state.vehicles.filter(v => !v.horaSalida);
                saveData();
                alert('Historial limpiado exitosamente');
                render();
            }
        }

        // Agregar ingreso extra
        function agregarIngresoExtra() {
            if (!state.extraConcepto.trim()) {
                alert('Por favor ingrese el concepto');
                return;
            }
            if (!state.extraMonto || state.extraMonto <= 0) {
                alert('Por favor ingrese un monto v√°lido');
                return;
            }

            const nuevoIngreso = {
                id: Date.now(),
                concepto: state.extraConcepto.trim(),
                monto: Number(state.extraMonto),
                fecha: new Date().toISOString()
            };

            state.extrasIncome.unshift(nuevoIngreso);
            state.extraConcepto = '';
            state.extraMonto = '';
            saveData();
            alert(`Ingreso extra registrado: ${nuevoIngreso.concepto} - ${formatearMoneda(nuevoIngreso.monto)}`);
            render();
        }

        // Eliminar ingreso extra
        function eliminarIngresoExtra(id) {
            if (confirm('¬øEst√° seguro de eliminar este ingreso extra?')) {
                state.extrasIncome = state.extrasIncome.filter(e => e.id !== id);
                saveData();
                render();
            }
        }

        // Limpiar ingresos extras
        function limpiarIngresosExtras() {
            if (state.extrasIncome.length === 0) {
                alert('No hay ingresos extras para eliminar');
                return;
            }
            
            if (confirm(`¬øEst√° seguro de eliminar TODOS los ingresos extras? (${state.extrasIncome.length} registros)`)) {
                state.extrasIncome = [];
                saveData();
                alert('Ingresos extras limpiados exitosamente');
                render();
            }
        }

        // Formatear fecha
        function formatearFecha(fecha) {
            return new Date(fecha).toLocaleString('es-CO', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Formatear moneda
        function formatearMoneda(valor) {
            return new Intl.NumberFormat('es-CO', {
                style: 'currency',
                currency: 'COP',
                minimumFractionDigits: 0
            }).format(valor);
        }

        // Obtener nombre del d√≠a de la semana
        function obtenerNombreDia(fecha) {
            const dias = ['Domingo', 'Lunes', 'Martes', 'Mi√©rcoles', 'Jueves', 'Viernes', 'S√°bado'];
            return dias[fecha.getDay()];
        }

        // Calcular ganancias por d√≠a
        function calcularGananciasPorDia() {
            const hoy = new Date();
            const gananciasPorDia = [];

            for (let i = 6; i >= 0; i--) {
                const fecha = new Date(hoy);
                fecha.setDate(hoy.getDate() - i);
                fecha.setHours(0, 0, 0, 0);

                const fechaFin = new Date(fecha);
                fechaFin.setHours(23, 59, 59, 999);

                const vehiculosDelDia = state.vehicles.filter(v => {
                    if (!v.horaSalida) return false;
                    const fechaSalida = new Date(v.horaSalida);
                    return fechaSalida >= fecha && fechaSalida <= fechaFin;
                });

                const extrasDelDia = state.extrasIncome.filter(e => {
                    const fechaExtra = new Date(e.fecha);
                    return fechaExtra >= fecha && fechaExtra <= fechaFin;
                });

                const totalParqueadero = vehiculosDelDia.reduce((sum, v) => sum + v.totalPagar, 0);
                const totalExtras = extrasDelDia.reduce((sum, e) => sum + e.monto, 0);
                const totalPlenas = vehiculosDelDia.filter(v => v.conPlena).length;
                const totalTiempo = vehiculosDelDia.filter(v => !v.conPlena).length;

                gananciasPorDia.push({
                    fecha: fecha,
                    nombreDia: obtenerNombreDia(fecha),
                    fechaFormato: fecha.toLocaleDateString('es-CO', { day: '2-digit', month: '2-digit', year: 'numeric' }),
                    totalParqueadero: totalParqueadero,
                    totalExtras: totalExtras,
                    total: totalParqueadero + totalExtras,
                    cantidadVehiculos: vehiculosDelDia.length,
                    cantidadExtras: extrasDelDia.length,
                    totalPlenas: totalPlenas,
                    totalTiempo: totalTiempo,
                    esHoy: i === 0
                });
            }

            return gananciasPorDia;
        }

        // Renderizar la aplicaci√≥n
        function render() {
            const vehiculosActivos = state.vehicles.filter(v => !v.horaSalida);
            const historial = state.vehicles.filter(v => v.horaSalida).slice(0, 20);

            const app = document.getElementById('app');
            app.innerHTML = `
                <!-- Header -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                    <div class="flex items-center gap-3 mb-4">
                        <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
                        </svg>
                        <h1 class="text-3xl font-bold text-gray-800">Parqueadero de Motos</h1>
                    </div>
                    
                    <div class="flex gap-2 mb-4">
                        <button onclick="changeTab('entrada')" class="px-4 py-2 rounded-lg font-semibold transition ${state.activeTab === 'entrada' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                            ‚ûï Entrada
                        </button>
                        <button onclick="changeTab('activos')" class="px-4 py-2 rounded-lg font-semibold transition ${state.activeTab === 'activos' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                            Motos Activas (${vehiculosActivos.length})
                        </button>
                        <button onclick="changeTab('historial')" class="px-4 py-2 rounded-lg font-semibold transition ${state.activeTab === 'historial' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                            Historial
                        </button>
                        <button onclick="changeTab('ganancias')" class="px-4 py-2 rounded-lg font-semibold transition ${state.activeTab === 'ganancias' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                            üí∞ Ganancias
                        </button>
                        <button onclick="changeTab('extras')" class="px-4 py-2 rounded-lg font-semibold transition ${state.activeTab === 'extras' ? 'bg-indigo-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}">
                            üõí Ingresos Extras
                        </button>
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <div class="flex items-center gap-3">
                            <label class="text-sm font-semibold text-gray-700">Tarifa por minuto:</label>
                            <input type="number" id="tarifaInput" value="${state.tarifaPorMinuto}" onchange="updateTarifa(this.value)" class="px-3 py-1 border border-gray-300 rounded-lg w-32">
                            <span class="text-sm text-gray-600">COP</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <label class="text-sm font-semibold text-gray-700">Valor Plena:</label>
                            <input type="number" id="valorPlenaInput" value="${state.valorPlena}" onchange="updateValorPlena(this.value)" class="px-3 py-1 border border-gray-300 rounded-lg w-32">
                            <span class="text-sm text-gray-600">COP</span>
                        </div>
                    </div>
                </div>

                ${renderTabContent(vehiculosActivos, historial)}
            `;
        }

        function renderTabContent(vehiculosActivos, historial) {
            if (state.activeTab === 'entrada') {
                return `
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Registrar Entrada</h2>
                        <div class="flex gap-3">
                            <input type="text" id="placaInput" placeholder="Placa (ej: ABC123)" value="${state.placa}" 
                                   class="flex-1 px-4 py-3 border border-gray-300 rounded-lg text-lg uppercase"
                                   onkeypress="if(event.key==='Enter') registrarEntrada()">
                            <button onclick="registrarEntrada()" class="px-6 py-3 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition">
                                Registrar Entrada
                            </button>
                        </div>
                    </div>
                `;
            }

            if (state.activeTab === 'activos') {
                return `
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-xl font-bold text-gray-800 mb-4">Motos en el Parqueadero</h2>
                        ${vehiculosActivos.length === 0 ? 
                            '<p class="text-gray-500 text-center py-8">No hay motos en el parqueadero</p>' :
                            vehiculosActivos.map(v => `
                                <div class="border border-gray-200 rounded-lg p-4 mb-3 hover:bg-gray-50">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="flex-1">
                                            <div class="flex items-center gap-2 mb-2">
                                                <span class="text-xl font-bold text-gray-800">${v.placa}</span>
                                            </div>
                                            <div class="text-sm text-gray-600">
                                                üïê Entrada: ${formatearFecha(v.horaEntrada)}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex gap-2">
                                        <button onclick="registrarSalida(${v.id}, false)" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition">
                                            üí≥ Pago por Tiempo
                                        </button>
                                        <button onclick="registrarSalida(${v.id}, true)" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition">
                                            ‚úÖ Pagar Plena (${formatearMoneda(state.valorPlena)})
                                        </button>
                                    </div>
                                </div>
                            `).join('')
                        }
                    </div>
                `;
            }

            if (state.activeTab === 'historial') {
                return `
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h2 class="text-xl font-bold text-gray-800">Historial de Salidas</h2>
                            ${historial.length > 0 ? `
                                <button onclick="limpiarHistorial()" class="px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition flex items-center gap-2">
                                    üóëÔ∏è Limpiar Todo
                                </button>
                            ` : ''}
                        </div>
                        ${historial.length === 0 ?
                            '<p class="text-gray-500 text-center py-8">No hay historial</p>' :
                            historial.map(v => `
                                <div class="border border-gray-200 rounded-lg p-4 mb-3">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-lg font-bold text-gray-800">${v.placa}</span>
                                            ${v.conPlena ? '<span class="px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded">PLENA</span>' : '<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded">POR TIEMPO</span>'}
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <span class="text-xl font-bold text-green-600">${formatearMoneda(v.totalPagar)}</span>
                                            <button onclick="eliminarRegistro(${v.id})" class="px-3 py-1.5 bg-red-500 text-white rounded-lg text-sm font-semibold hover:bg-red-600 transition" title="Eliminar este registro">
                                                ‚ùå Eliminar
                                            </button>
                                        </div>
                                    </div>
                                    <div class="grid grid-cols-2 gap-2 text-sm text-gray-600">
                                        <span>Entrada: ${formatearFecha(v.horaEntrada)}</span>
                                        <span>Salida: ${formatearFecha(v.horaSalida)}</span>
                                    </div>
                                </div>
                            `).join('')
                        }
                    </div>
                `;
            }

            if (state.activeTab === 'ganancias') {
                const gananciasPorDia = calcularGananciasPorDia();
                const totalSemana = gananciasPorDia.reduce((sum, dia) => sum + dia.total, 0);
                const totalParqueaderoSemana = gananciasPorDia.reduce((sum, dia) => sum + dia.totalParqueadero, 0);
                const totalExtrasSemana = gananciasPorDia.reduce((sum, dia) => sum + dia.totalExtras, 0);
                const totalVehiculosSemana = gananciasPorDia.reduce((sum, dia) => sum + dia.cantidadVehiculos, 0);

                return `
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üí∞ Ganancias de los √öltimos 7 D√≠as</h2>
                        
                        <!-- Resumen Total -->
                        <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 mb-6 text-white">
                            <div class="grid grid-cols-4 gap-4">
                                <div>
                                    <p class="text-green-100 text-sm mb-1">Total Semana</p>
                                    <p class="text-3xl font-bold">${formatearMoneda(totalSemana)}</p>
                                </div>
                                <div>
                                    <p class="text-green-100 text-sm mb-1">Parqueadero</p>
                                    <p class="text-2xl font-bold">${formatearMoneda(totalParqueaderoSemana)}</p>
                                </div>
                                <div>
                                    <p class="text-green-100 text-sm mb-1">Extras</p>
                                    <p class="text-2xl font-bold">${formatearMoneda(totalExtrasSemana)}</p>
                                </div>
                                <div>
                                    <p class="text-green-100 text-sm mb-1">Veh√≠culos</p>
                                    <p class="text-3xl font-bold">${totalVehiculosSemana}</p>
                                </div>
                            </div>
                        </div>

                        <!-- Desglose por D√≠a -->
                        <div class="space-y-3">
                            ${gananciasPorDia.map(dia => `
                                <div class="border-2 ${dia.esHoy ? 'border-indigo-400 bg-indigo-50' : 'border-gray-200'} rounded-lg p-4">
                                    <div class="flex items-center justify-between mb-3">
                                        <div>
                                            <div class="flex items-center gap-2">
                                                <span class="text-lg font-bold text-gray-800">${dia.nombreDia}</span>
                                                ${dia.esHoy ? '<span class="px-2 py-1 bg-indigo-500 text-white text-xs font-semibold rounded">HOY</span>' : ''}
                                            </div>
                                            <span class="text-sm text-gray-600">${dia.fechaFormato}</span>
                                        </div>
                                        <div class="text-right">
                                            <p class="text-2xl font-bold text-green-600">${formatearMoneda(dia.total)}</p>
                                            <p class="text-xs text-gray-600">Parq: ${formatearMoneda(dia.totalParqueadero)} | Extras: ${formatearMoneda(dia.totalExtras)}</p>
                                        </div>
                                    </div>
                                    ${dia.cantidadVehiculos > 0 || dia.cantidadExtras > 0 ? `
                                        <div class="flex gap-4 text-sm flex-wrap">
                                            ${dia.cantidadVehiculos > 0 ? `
                                                <div class="flex items-center gap-1">
                                                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded">PLENAS</span>
                                                    <span class="text-gray-700 font-semibold">${dia.totalPlenas}</span>
                                                </div>
                                                <div class="flex items-center gap-1">
                                                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded">POR TIEMPO</span>
                                                    <span class="text-gray-700 font-semibold">${dia.totalTiempo}</span>
                                                </div>
                                            ` : ''}
                                            ${dia.cantidadExtras > 0 ? `
                                                <div class="flex items-center gap-1">
                                                    <span class="px-2 py-1 bg-purple-100 text-purple-800 text-xs font-semibold rounded">EXTRAS</span>
                                                    <span class="text-gray-700 font-semibold">${dia.cantidadExtras}</span>
                                                </div>
                                            ` : ''}
                                        </div>
                                    ` : '<p class="text-sm text-gray-500 italic">Sin registro de ventas</p>'}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            if (state.activeTab === 'extras') {
                const extrasHoy = state.extrasIncome.filter(e => {
                    const hoy = new Date();
                    hoy.setHours(0, 0, 0, 0);
                    const fechaExtra = new Date(e.fecha);
                    fechaExtra.setHours(0, 0, 0, 0);
                    return fechaExtra.getTime() === hoy.getTime();
                });
                const totalHoy = extrasHoy.reduce((sum, e) => sum + e.monto, 0);

                return `
                    <div class="bg-white rounded-lg shadow-lg p-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üõí Ingresos Extras</h2>
                        
                        <!-- Formulario para agregar -->
                        <div class="bg-purple-50 border-2 border-purple-200 rounded-lg p-6 mb-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Registrar Nuevo Ingreso</h3>
                            <div class="grid grid-cols-2 gap-3 mb-3">
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Concepto</label>
                                    <input type="text" id="conceptoInput" placeholder="Ej: Agua, Hielo, Gaseosa" value="${state.extraConcepto}"
                                           class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                           onkeypress="if(event.key==='Enter') document.getElementById('montoInput').focus()">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Monto (COP)</label>
                                    <input type="number" id="montoInput" placeholder="5000" value="${state.extraMonto}"
                                           class="w-full px-4 py-2 border border-gray-300 rounded-lg"
                                           onkeypress="if(event.key==='Enter') agregarIngresoExtra()">
                                </div>
                            </div>
                            <button onclick="agregarIngresoExtra()" class="w-full px-6 py-3 bg-purple-600 text-white rounded-lg font-semibold hover:bg-purple-700 transition">
                                ‚ûï Agregar Ingreso Extra
                            </button>
                        </div>

                        <!-- Resumen de hoy -->
                        ${extrasHoy.length > 0 ? `
                            <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-4 mb-6 text-white">
                                <p class="text-purple-100 text-sm mb-1">Total Extras Hoy</p>
                                <p class="text-3xl font-bold">${formatearMoneda(totalHoy)}</p>
                                <p class="text-purple-100 text-sm">${extrasHoy.length} registro${extrasHoy.length !== 1 ? 's' : ''}</p>
                            </div>
                        ` : ''}

                        <!-- Lista de ingresos extras -->
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-lg font-bold text-gray-800">Historial de Ingresos Extras</h3>
                            ${state.extrasIncome.length > 0 ? `
                                <button onclick="limpiarIngresosExtras()" class="px-4 py-2 bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition text-sm">
                                    üóëÔ∏è Limpiar Todo
                                </button>
                            ` : ''}
                        </div>

                        ${state.extrasIncome.length === 0 ?
                            '<p class="text-gray-500 text-center py-8">No hay ingresos extras registrados</p>' :
                            `<div class="space-y-3">
                                ${state.extrasIncome.slice(0, 50).map(extra => `
                                    <div class="border border-purple-200 bg-purple-50 rounded-lg p-4">
                                        <div class="flex items-center justify-between">
                                            <div class="flex-1">
                                                <div class="flex items-center gap-2 mb-1">
                                                    <span class="text-lg font-bold text-gray-800">${extra.concepto}</span>
                                                    <span class="px-2 py-1 bg-purple-500 text-white text-xs font-semibold rounded">EXTRA</span>
                                                </div>
                                                <p class="text-sm text-gray-600">üìÖ ${formatearFecha(extra.fecha)}</p>
                                            </div>
                                            <div class="flex items-center gap-3">
                                                <span class="text-2xl font-bold text-purple-600">${formatearMoneda(extra.monto)}</span>
                                                <button onclick="eliminarIngresoExtra(${extra.id})" class="px-3 py-1.5 bg-red-500 text-white rounded-lg text-sm font-semibold hover:bg-red-600 transition">
                                                    ‚ùå
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>`
                        }
                    </div>
                `;
            }
        }

        // Event handlers
        function changeTab(tab) {
            state.activeTab = tab;
            render();
            if (tab === 'entrada') {
                setTimeout(() => document.getElementById('placaInput')?.focus(), 100);
            } else if (tab === 'extras') {
                setTimeout(() => document.getElementById('conceptoInput')?.focus(), 100);
            }
        }

        function updateTarifa(value) {
            state.tarifaPorMinuto = Number(value);
            render();
        }

        function updateValorPlena(value) {
            state.valorPlena = Number(value);
            render();
        }

        // Actualizar campos desde inputs
        document.addEventListener('input', (e) => {
            if (e.target.id === 'placaInput') {
                state.placa = e.target.value.toUpperCase();
            } else if (e.target.id === 'conceptoInput') {
                state.extraConcepto = e.target.value;
            } else if (e.target.id === 'montoInput') {
                state.extraMonto = e.target.value;
            }
        });

        // Inicializar
        render();
        setTimeout(() => document.getElementById('placaInput')?.focus(), 100);
    </script>
</body>
</html>
